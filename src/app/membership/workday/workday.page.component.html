<div class="container flex py-5">
  <!-- Header -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div></div>
    <div class="form-group text-center">
      <label for="workDay" class="form-label fw-bold">Working Day</label>
      <input
        type="date"
        class="form-control"
        id="workDay"
        [ngModel]="selectedDate"
        (ngModelChange)="localStore.updateWorkdayDate($event)"
      />
    </div>
    <button class="btn btn-success align-self-end">Start the work day</button>
  </div>

  @if (localStore.hasNoPlannedTasks()) {
    <app-empty-workday />
  } @else {
    @for (task of localStore.workday().taskList; track $index) {
      @if ($index === 0) {
        <h6 class="mt-2">Most important task</h6>
      } @else if ($index === 1) {
        <h6 class="mt-2">T√¢ches de seconde importance</h6>
      } @else if ($index === 3) {
        <h6 class="mt-2">T√¢ches restantes</h6>
      }

      <div class="card p-3 d-flex flex-row align-items-center justify-content-between" data-testid="task-card">
        <div class="d-flex align-items-center gap-2">
          <select
            class="form-select w-auto"
            [ngModel]="task.type"
            (ngModelChange)="localStore.updateTask($index, { type: $event })"
            data-testid="task-type-select"
          >
            <option [ngValue]="'Hit the target'">‚õ≥Ô∏è</option>
            <option [ngValue]="'Get things done'">üéØ</option>
          </select>
          <input
            class="fs-5"
            [ngModel]="task.title"
            (ngModelChange)="localStore.updateTask($index, { title: $event })"
            data-testid="task-title-input"
          />
        </div>
        <div class="d-flex align-items-center gap-2">
          <select
            class="form-select w-auto"
            (ngModelChange)="localStore.updateTask($index, { pomodoroCount: $event })"
            [ngModel]="task.pomodoroCount"
            data-testid="task-pomodoro-count-select"
          >
            @for (count of pomodoroOptions; track count) {
              <option [ngValue]="count">{{ count }}</option>
            }
          </select>
          <div class="d-flex gap-1">
            @for (pomodoro of task.pomodoroList; track $index) {
              <button class="btn btn-sm" data-testid="task-pomodoro-button">
                <i class="bi bi-pause-btn-fill text-secondary fs-5"></i>
              </button>
            }
          </div>
          <span class="fs-5">0</span>
          <span class="fs-5">üèÅ</span>
          <button class="btn btn-sm" (click)="localStore.removeTask($index)" data-testid="task-delete-button">
            <i class="bi bi-x-lg text-secondary"></i>
          </button>
        </div>
      </div>
    }
  }

  @if (localStore.shouldDisplayAddButton()) {
    <!-- Add Task Link -->
    <div class="text-center">
      <button (click)="localStore.onAddTask()" class="btn btn-link text-muted" data-testid="add-task-button">
        Ajouter une t√¢che
      </button>
    </div>
  }
</div>
